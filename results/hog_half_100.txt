Using gpu device 1: GeForce GTX TITAN X (CNMeM is disabled)
Using wide ResNet with depth 18 and width 1.
ResBlock1 output size: (None, 16, 32, 32)
Train set size: (45000, 4, 32, 32), Test set size: (5000, 4, 32, 32)
Train shape: (22500, 4, 32, 32) Test shape: (2500, 4, 32, 32)
Train y shape: (22500,) Test y shape: (2500,)
163.088 -140.152 0.948567
iter: 0 | TL: 3.295 | VL: 1.849 | Vacc: 0.3 | Ratio: 1.78 | Time: 802.9
iter: 1 | TL: 3.003 | VL: 1.671 | Vacc: 0.344 | Ratio: 1.8 | Time: 782.4
iter: 2 | TL: 2.862 | VL: 1.439 | Vacc: 0.464 | Ratio: 1.99 | Time: 785.7
iter: 3 | TL: 2.747 | VL: 1.407 | Vacc: 0.482 | Ratio: 1.95 | Time: 766.6
iter: 4 | TL: 2.639 | VL: 1.271 | Vacc: 0.537 | Ratio: 2.08 | Time: 768.8
iter: 5 | TL: 2.55 | VL: 1.221 | Vacc: 0.574 | Ratio: 2.09 | Time: 774.0
iter: 6 | TL: 2.458 | VL: 1.286 | Vacc: 0.558 | Ratio: 1.91 | Time: 782.3
iter: 7 | TL: 2.383 | VL: 1.203 | Vacc: 0.6 | Ratio: 1.98 | Time: 781.8
iter: 8 | TL: 2.321 | VL: 1.014 | Vacc: 0.645 | Ratio: 2.29 | Time: 778.3
iter: 9 | TL: 2.264 | VL: 0.991 | Vacc: 0.649 | Ratio: 2.29 | Time: 799.9
iter: 10 | TL: 2.212 | VL: 0.898 | Vacc: 0.686 | Ratio: 2.46 | Time: 801.0
iter: 11 | TL: 2.174 | VL: 0.894 | Vacc: 0.691 | Ratio: 2.43 | Time: 776.0
iter: 12 | TL: 2.127 | VL: 0.926 | Vacc: 0.686 | Ratio: 2.3 | Time: 773.7
iter: 13 | TL: 2.093 | VL: 0.913 | Vacc: 0.694 | Ratio: 2.29 | Time: 777.2
iter: 14 | TL: 2.049 | VL: 0.872 | Vacc: 0.707 | Ratio: 2.35 | Time: 766.0
iter: 15 | TL: 2.014 | VL: 0.841 | Vacc: 0.702 | Ratio: 2.4 | Time: 771.4
iter: 16 | TL: 1.981 | VL: 0.827 | Vacc: 0.708 | Ratio: 2.39 | Time: 777.6
iter: 17 | TL: 1.941 | VL: 0.865 | Vacc: 0.704 | Ratio: 2.24 | Time: 797.6
iter: 18 | TL: 1.912 | VL: 0.76 | Vacc: 0.729 | Ratio: 2.52 | Time: 793.8
iter: 19 | TL: 1.877 | VL: 0.77 | Vacc: 0.738 | Ratio: 2.44 | Time: 812.5
iter: 20 | TL: 1.846 | VL: 0.748 | Vacc: 0.737 | Ratio: 2.47 | Time: 796.7
iter: 21 | TL: 1.819 | VL: 0.732 | Vacc: 0.746 | Ratio: 2.49 | Time: 777.6
iter: 22 | TL: 1.788 | VL: 0.805 | Vacc: 0.734 | Ratio: 2.22 | Time: 778.8
iter: 23 | TL: 1.755 | VL: 0.741 | Vacc: 0.75 | Ratio: 2.37 | Time: 772.7
iter: 24 | TL: 1.725 | VL: 0.702 | Vacc: 0.751 | Ratio: 2.46 | Time: 783.8
iter: 25 | TL: 1.705 | VL: 0.825 | Vacc: 0.741 | Ratio: 2.07 | Time: 792.7
iter: 26 | TL: 1.676 | VL: 0.713 | Vacc: 0.752 | Ratio: 2.35 | Time: 802.8
iter: 27 | TL: 1.643 | VL: 0.747 | Vacc: 0.754 | Ratio: 2.2 | Time: 809.9
iter: 28 | TL: 1.616 | VL: 0.728 | Vacc: 0.762 | Ratio: 2.22 | Time: 785.6
iter: 29 | TL: 1.592 | VL: 0.657 | Vacc: 0.775 | Ratio: 2.42 | Time: 792.7
iter: 30 | TL: 1.574 | VL: 0.646 | Vacc: 0.771 | Ratio: 2.44 | Time: 800.9
iter: 31 | TL: 1.543 | VL: 0.746 | Vacc: 0.757 | Ratio: 2.07 | Time: 780.3
iter: 32 | TL: 1.516 | VL: 0.691 | Vacc: 0.781 | Ratio: 2.19 | Time: 792.7
iter: 33 | TL: 1.496 | VL: 0.693 | Vacc: 0.777 | Ratio: 2.16 | Time: 798.7
iter: 34 | TL: 1.471 | VL: 0.665 | Vacc: 0.782 | Ratio: 2.21 | Time: 808.6
iter: 35 | TL: 1.451 | VL: 0.616 | Vacc: 0.791 | Ratio: 2.36 | Time: 806.4
iter: 36 | TL: 1.423 | VL: 0.709 | Vacc: 0.782 | Ratio: 2.01 | Time: 809.0
iter: 37 | TL: 1.404 | VL: 0.625 | Vacc: 0.808 | Ratio: 2.25 | Time: 781.9
iter: 38 | TL: 1.379 | VL: 0.587 | Vacc: 0.8 | Ratio: 2.35 | Time: 778.8
iter: 39 | TL: 1.363 | VL: 0.612 | Vacc: 0.804 | Ratio: 2.23 | Time: 787.5
iter: 40 | TL: 1.347 | VL: 0.672 | Vacc: 0.783 | Ratio: 2.0 | Time: 782.2
iter: 41 | TL: 1.325 | VL: 0.53 | Vacc: 0.827 | Ratio: 2.5 | Time: 790.9
iter: 42 | TL: 1.301 | VL: 0.587 | Vacc: 0.811 | Ratio: 2.22 | Time: 800.8
iter: 43 | TL: 1.283 | VL: 0.576 | Vacc: 0.81 | Ratio: 2.23 | Time: 799.9
iter: 44 | TL: 1.267 | VL: 0.592 | Vacc: 0.803 | Ratio: 2.14 | Time: 796.1
iter: 45 | TL: 1.248 | VL: 0.619 | Vacc: 0.807 | Ratio: 2.02 | Time: 788.8
iter: 46 | TL: 1.229 | VL: 0.572 | Vacc: 0.816 | Ratio: 2.15 | Time: 786.8
iter: 47 | TL: 1.219 | VL: 0.49 | Vacc: 0.833 | Ratio: 2.49 | Time: 789.3
iter: 48 | TL: 1.2 | VL: 0.563 | Vacc: 0.83 | Ratio: 2.13 | Time: 798.3
iter: 49 | TL: 1.177 | VL: 0.55 | Vacc: 0.824 | Ratio: 2.14 | Time: 809.5
iter: 50 | TL: 1.163 | VL: 0.52 | Vacc: 0.823 | Ratio: 2.24 | Time: 823.7
iter: 51 | TL: 1.147 | VL: 0.563 | Vacc: 0.829 | Ratio: 2.04 | Time: 827.3
iter: 52 | TL: 1.134 | VL: 0.514 | Vacc: 0.826 | Ratio: 2.2 | Time: 818.8
iter: 53 | TL: 1.115 | VL: 0.537 | Vacc: 0.825 | Ratio: 2.08 | Time: 811.3
iter: 54 | TL: 1.104 | VL: 0.536 | Vacc: 0.83 | Ratio: 2.06 | Time: 809.0
iter: 55 | TL: 1.087 | VL: 0.489 | Vacc: 0.839 | Ratio: 2.22 | Time: 804.8
iter: 56 | TL: 1.076 | VL: 0.528 | Vacc: 0.826 | Ratio: 2.04 | Time: 813.2
iter: 57 | TL: 1.06 | VL: 0.549 | Vacc: 0.829 | Ratio: 1.93 | Time: 827.7
iter: 58 | TL: 1.049 | VL: 0.518 | Vacc: 0.826 | Ratio: 2.03 | Time: 853.7
iter: 59 | TL: 1.025 | VL: 0.527 | Vacc: 0.838 | Ratio: 1.94 | Time: 855.5
iter: 60 | TL: 1.026 | VL: 0.466 | Vacc: 0.847 | Ratio: 2.2 | Time: 846.3
iter: 61 | TL: 1.013 | VL: 0.484 | Vacc: 0.845 | Ratio: 2.09 | Time: 835.9
iter: 62 | TL: 0.995 | VL: 0.604 | Vacc: 0.816 | Ratio: 1.65 | Time: 829.1
iter: 63 | TL: 0.983 | VL: 0.527 | Vacc: 0.832 | Ratio: 1.86 | Time: 831.6
iter: 64 | TL: 0.97 | VL: 0.508 | Vacc: 0.842 | Ratio: 1.91 | Time: 802.4
iter: 65 | TL: 0.963 | VL: 0.449 | Vacc: 0.854 | Ratio: 2.15 | Time: 801.7
iter: 66 | TL: 0.948 | VL: 0.52 | Vacc: 0.841 | Ratio: 1.82 | Time: 809.3
iter: 67 | TL: 0.934 | VL: 0.523 | Vacc: 0.846 | Ratio: 1.79 | Time: 831.1
iter: 68 | TL: 0.919 | VL: 0.493 | Vacc: 0.852 | Ratio: 1.87 | Time: 818.6
iter: 69 | TL: 0.915 | VL: 0.479 | Vacc: 0.847 | Ratio: 1.91 | Time: 811.2
iter: 70 | TL: 0.899 | VL: 0.527 | Vacc: 0.838 | Ratio: 1.71 | Time: 807.7
iter: 71 | TL: 0.9 | VL: 0.47 | Vacc: 0.856 | Ratio: 1.91 | Time: 807.6
iter: 72 | TL: 0.884 | VL: 0.503 | Vacc: 0.845 | Ratio: 1.76 | Time: 813.6
iter: 73 | TL: 0.865 | VL: 0.457 | Vacc: 0.848 | Ratio: 1.89 | Time: 805.3
iter: 74 | TL: 0.857 | VL: 0.515 | Vacc: 0.85 | Ratio: 1.66 | Time: 823.2
iter: 75 | TL: 0.849 | VL: 0.493 | Vacc: 0.849 | Ratio: 1.72 | Time: 819.6
iter: 76 | TL: 0.839 | VL: 0.485 | Vacc: 0.848 | Ratio: 1.73 | Time: 852.7
iter: 77 | TL: 0.827 | VL: 0.453 | Vacc: 0.867 | Ratio: 1.83 | Time: 836.3
iter: 78 | TL: 0.819 | VL: 0.514 | Vacc: 0.847 | Ratio: 1.59 | Time: 831.8
iter: 79 | TL: 0.81 | VL: 0.529 | Vacc: 0.84 | Ratio: 1.53 | Time: 840.2
iter: 80 | TL: 0.808 | VL: 0.466 | Vacc: 0.859 | Ratio: 1.73 | Time: 844.6
iter: 81 | TL: 0.793 | VL: 0.477 | Vacc: 0.852 | Ratio: 1.66 | Time: 849.3
iter: 82 | TL: 0.794 | VL: 0.509 | Vacc: 0.852 | Ratio: 1.56 | Time: 846.8
iter: 83 | TL: 0.788 | VL: 0.44 | Vacc: 0.863 | Ratio: 1.79 | Time: 841.4
iter: 84 | TL: 0.769 | VL: 0.465 | Vacc: 0.859 | Ratio: 1.65 | Time: 837.1
iter: 85 | TL: 0.754 | VL: 0.555 | Vacc: 0.845 | Ratio: 1.36 | Time: 845.5
iter: 86 | TL: 0.752 | VL: 0.46 | Vacc: 0.862 | Ratio: 1.63 | Time: 843.7
iter: 87 | TL: 0.741 | VL: 0.458 | Vacc: 0.863 | Ratio: 1.62 | Time: 841.7
iter: 88 | TL: 0.733 | VL: 0.464 | Vacc: 0.856 | Ratio: 1.58 | Time: 519.4
iter: 89 | TL: 0.723 | VL: 0.474 | Vacc: 0.866 | Ratio: 1.53 | Time: 372.4
iter: 90 | TL: 0.717 | VL: 0.51 | Vacc: 0.852 | Ratio: 1.41 | Time: 364.8
iter: 91 | TL: 0.712 | VL: 0.46 | Vacc: 0.852 | Ratio: 1.55 | Time: 362.9
iter: 92 | TL: 0.705 | VL: 0.436 | Vacc: 0.865 | Ratio: 1.62 | Time: 364.3
iter: 93 | TL: 0.694 | VL: 0.509 | Vacc: 0.861 | Ratio: 1.36 | Time: 381.3
iter: 94 | TL: 0.692 | VL: 0.441 | Vacc: 0.857 | Ratio: 1.57 | Time: 366.1
iter: 95 | TL: 0.672 | VL: 0.49 | Vacc: 0.865 | Ratio: 1.37 | Time: 364.1
iter: 96 | TL: 0.684 | VL: 0.442 | Vacc: 0.864 | Ratio: 1.55 | Time: 364.0
iter: 97 | TL: 0.679 | VL: 0.497 | Vacc: 0.862 | Ratio: 1.37 | Time: 364.8
iter: 98 | TL: 0.656 | VL: 0.478 | Vacc: 0.864 | Ratio: 1.37 | Time: 364.0
iter: 99 | TL: 0.656 | VL: 0.489 | Vacc: 0.853 | Ratio: 1.34 | Time: 362.5
Final Acc: 0.867188
Traceback (most recent call last):
  File "train_nn.py", line 153, in <module>
    pyplot.savefig('plots/%s%d_resnet.png'%(variant,depth))
  File "/usr/local/lib/python2.7/dist-packages/matplotlib/pyplot.py", line 688, in savefig
    res = fig.savefig(*args, **kwargs)
  File "/usr/local/lib/python2.7/dist-packages/matplotlib/figure.py", line 1565, in savefig
    self.canvas.print_figure(*args, **kwargs)
  File "/usr/local/lib/python2.7/dist-packages/matplotlib/backend_bases.py", line 2232, in print_figure
    **kwargs)
  File "/usr/local/lib/python2.7/dist-packages/matplotlib/backends/backend_agg.py", line 532, in print_png
    filename_or_obj = open(filename_or_obj, 'wb')
IOError: [Errno 2] No such file or directory: 'plots/wide18_resnet.png'
